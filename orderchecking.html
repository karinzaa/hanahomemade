<!DOCTYPE html>
<html lang="en,th">

<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <meta name="theme-color" content="#000000">
      <meta name="HANA Homemade" content="Order Checking">

      <title>Order Checking</title>

      <!-- stylesheet -->
      <link rel="stylesheet" href="style.css">

      <!-- bootstrap cdns -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
      <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>

      <!-- fontawesome cdns -->
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.0/css/all.css">
      <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css">

      <!-- google fonts -->
      <link href="https://fonts.googleapis.com/css?family=Niramit:100,100i,300,300i,400,400i,500,500i,700,700i"
            rel="stylesheet">
      <link href="https://fonts.googleapis.com/css?family=Sriracha:200,200i,300,300i,400,400i,500,500i,600,600i,700,700i"
            rel="stylesheet">
      <link rel="icon" href="pic/HanaLogoIcon.png">
      

      <!-- for on scroll animations -->
      <link rel="stylesheet" href="animate.css">
      <script src="wow.min.js"></script>


</head>

<body>
      <div class="wrapper">

            <!--------------- navbar starts here --------------->
            <nav>
                  <span id="brand" class="circleScaleBtn2 logo" onclick="location.href='index.html'">
                        <img width="auto" height="55" src="pic/HanaLogoWeb.png"></img>  
                  </span>

                  <ul id="menu">
                        <li><a href="products.html" class="borderFade"><i class="fas fa-bread-slice"></i> Products<span></span></a></li>
                        <li><a href="orderchecking.html" class="borderFade"><i class="fas fa-shopping-bag"></i> Order Checking<span></span></a></li>
                        <li><a href="aboutme.html" class="borderFade"><i class="fas fa-info-circle"></i> About Me<span></span></a></li>
                  </ul>

                  <div id="toggle">
                        <i class="fas fa-bars wow fadeInUp span" data-wow-delay="0.6s "></i>
                  </div>

            </nav>

            <div id="resize">
                  <div class="close-btn">
                        <i class="far fa-times-circle wow fadeInUp span" data-wow-delay="0.6s "></i>
                  </div>

                  <ul id="menu">
                        <li><a href="products.html" class="borderFade"><i class="fas fa-bread-slice"></i> Products<span></span></a></li>
                        <li><a href="orderchecking.html" class="borderFade"><i class="fas fa-shopping-bag"></i> Order Checking<span></span></a></li>
                        <li><a href="aboutme.html" class="borderFade"><i class="fas fa-info-circle"></i> About Me<span></span></a></li>
                  </ul>
            </div>

            <!--------------- navbar ends here --------------->

            <div class="whitespace"></div>

            <!--------------- hero section starts here --------------->
            <div class="container">
                  <div class="hero-content">
                        <br></br>
                        <div class="row">
                              <div class="col-lg-12">
                                    <h1 class="wow fadeInUp" data-wow-delay="0.4s"><i class="fas fa-shopping-bag"></i> Order Checking</h1>
                                    <p class="wow fadeInUp" data-wow-delay="0.5s">
                                          ท่านจะหา order จะตาม order ดูสถานะ order ดู Tracking ID ของ order ของคุณได้ที่นี่
                                    </p>
                                   <!-- <img class="wow fadeInUp center border border-light round" data-wow-delay="0.6s" src="OrderChecking.jpg" alt="IO Database" style="width: 100%; height: auto"> -->
                              </div>
                        </div>
                  </div>
            </div>

            <!--------------- hero section ends here --------------->

            <!--------------- content info section starts here --------------->

            <div class="container">
                  <div class="hero-content">
                        <br></br>
                        <div class="row">
                              <div class="col-lg-12 wow fadeInUp" data-wow-delay="0.5s">
                                    <h2 class="wow fadeInUp" data-wow-delay="0.4s"><i class="fas fa-clipboard-list"></i> Orders Data List</h2>
                                    <p class="wow fadeInUp" data-wow-delay="0.5s">
                                          <span class="badge badge-light">ท่านสามารถ</span> ดูสถานะ order ดู Tracking ID ของ order ของคุณได้ที่นี่ <i class="fas fa-arrow-circle-down"></i></p>
                                    </p>
                                    <div class="wow fadeInUp" data-wow-delay="0.5s">
                                    <button type="button" data-toggle="modal" data-target="#ioTable" class="btn btn-outline-light btn-block btn-lg wow fadeInUp" data-wow-delay="0.6s" ><i class="fas fa-clipboard-check"></i> Check Orders List</button>
                                    </div>
                                    <br>
                                    
                              </div>
                        </div>
                  </div>
            </div>

            <div class="container">
                  <div class="hero-content">
                        <br></br>
                        <div class="row">
                              <div class="col-lg-12 wow fadeInUp" data-wow-delay="0.5s">
                                    <h2 class="wow fadeInUp" data-wow-delay="0.4s"><i class="fas fa-truck-loading"></i> Works Load</h2>
                                    <p class="wow fadeInUp" data-wow-delay="0.5s">
                                          <span class="badge badge-light">Chart</span> แบ่งตามสถานะงานของ จrders ณ ขณะนี้</p>
                                          <p class="wow fadeInUp" data-wow-delay="0.5s">
                                                <p class="wow fadeInUp" data-wow-delay="0.5s"><span class="badge badge-pill list2"><i class="far fa-bell ripple2"></i> Lasted update</span> 
                                                      <i class="fas fa-calendar-day"></i> <span id="time"></span>
                                                </p>
                                                <div class="row wow fadeInUp" data-wow-delay="0.5s">
                                                      <div class="col-sm-12">
                                                            <div class="card text-white border-light mb-1 mb-1 bg-custom-1 wow fadeInUp" data-wow-delay="0.6s" style="height: 3rem;">
                                                                  <div class="card-body borderFade"><h5 class="cen">Total</h5>
                                                                    <h5 class="card-title centered"> <span id="sum"></span> Orders</h5>
                                                                  </div>
                                                            </div>  
                                                      </div>
                                                      <div class="col-sm-4">
                                                            <div class="card text-white border-primary mb-1 bg-custom-1 wow fadeInUp" data-wow-delay="0.6s" style="height: 3rem;">
                                                                  <div class="card-body borderFade"><i class="fas fa-sign-in-alt cen"></i>
                                                                    <h5 class="card-title centered"> <span id="iput"></span></h5>
                                                                  </div>
                                                            </div>    
                                                      </div>
                                                      <div class="col-sm-4">
                                                             <div class="card text-white border-warning mb-1 bg-custom-1 wow fadeInUp" data-wow-delay="0.6s" style="height: 3rem;">
                                                                  <div class="card-body borderFade"><i class="fas fa-industry cen"></i>
                                                                    <h5 class="card-title centered"> <span id="make"></span></h5>
                                                                  </div>
                                                            </div>
                                                      </div>
                                                      <div class="col-sm-4">
                                                            <div class="card text-white border-success mb-1 bg-custom-1 wow fadeInUp" data-wow-delay="0.6s" style="height: 3rem;">
                                                                  <div class="card-body borderFade"><i class="fas fa-sign-out-alt cen"></i>
                                                                    <h5 class="card-title centered"> <span id="oput"></span></h5>
                                                                  </div>
                                                            </div>
                                                    </div>
                                    </p>
                                          <div class="container wow fadeInUp" data-wow-delay="0.5s">
                                          <br></br>
                                          </div>
                                    <canvas id="StatusChart"></canvas>
                              </div>
                             
                              </div>
                        </div>
                  </div>
            </div>

            <div class="container">
                  <div class="hero-content">
                        <br></br>
                        <div class="row">
                              <div class="col-lg-12">
                                    <h2 class="wow fadeInUp" data-wow-delay="0.4s"><i class="far fa-life-ring"></i> Support</h2>
                                    <p class="wow fadeInUp" data-wow-delay="0.5s">
                                          เมื่อคุณ <span class="badge badge-light">! ไม่เจอ Orders !</span> ต้องคุณต้องทำอย่างไร
                                    </p>
                                    <div class="container wow fadeInUp" data-wow-delay="0.5s">
                                    <p class="wow fadeInUp" data-wow-delay="0.5s"><span class="badge badge-light"><i class="far fa-life-ring"></i> กดขอความช่วยเหลือ</span> ได้ที่ปุ่มด้านล่างนี้ได้เลย <i class="fas fa-arrow-circle-down"></i></p>
                                    </div>

                                    <div class="row wow fadeInUp" data-wow-delay="0.5s">
                                    <div class="col-sm-12">
                                          <button type="button" data-toggle="modal" data-target="#support" class="btn btn-outline-light btn-block btn-lg wow fadeInUp" data-wow-delay="0.6s" ><i class="far fa-life-ring"></i> ติอต่อความช่วยเหลือ</button>
                                    </div>
                                    
      
                              </div>
                        </div>
                  </div>
            </div>

            <!--------------- types section ends here --------------->

            <!--------------- footer starts here --------------->
            <div class="footer">
                  <div class="container">
                       
                        <div class="collab">
                              <div class="row">
                                    <div class="col-lg-12">
                                          <p class="wow fadeInUp"></p>
                                    </div>
                              </div>
                        </div>
      
                        <br>
      
                        <div class="hr">
                              <div class="row"></div>
                        </div>
      
                        <br></br>
      
                        <div class="info">
                              <div class="row">
                                    <div class="col-md-4" id="personal">
                                          <h5 class="wow fadeInUp footer" data-wow-delay="0.2s"><img width="auto" height="55" src="pic/HanaLogoWeb.png"></img>  </h5>
                                          <p class="wow fadeInUp list badge badge-pill circleScaleBtn2" type="button" onclick="location.href='https://creativecommons.org/publicdomain/zero/1.0/'"><i class="fab fa-creative-commons"></i> <i class="fab fa-creative-commons-zero"></i> <i class="fab fa-creative-commons-share"></i></p>
                                    </div>
      
                                   
      
                                    <div class="col-md-8" id="media">
      
                                          <ul>
                                                <li class="wow fadeInUp" data-wow-delay="0.4s"> <p class="wow fadeInUp list1 badge badge-pill badge-light circleScaleBtn2" type="button" onclick="location.href='https://www.facebook.com/HANAHomeBakery/'"><i class="fab fa-facebook"> <img width="auto" height="30" src="pic/HanaLogoWeb.png"></img></i> </p> </li>
                                          </ul>
                                          <p class="wow fadeInUp list2 badge badge-pill badge-light circleScaleBtn2" type="button" onclick="location.href='termsofservice.html'"><i class="fas fa-info-circle"></i> ข้อกำหนด นโยบายความเป็นส่วนตัว</p>
      
                                          
                                    </div>
                              </div>
                        </div>
                  </div>
            </div>
            <!--------------- footer ends here --------------->

            <br></br>

      </div>
  
      <div id="myModal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog modal-dialog-centered">

              <div class="modal-content ripple1">
                <div class="modal-header">
                  <h4 class="modal-title"><i class="fas fa-info-circle"></i> ข้อตกลงเงื่อนใขในการใช้งาน</h4>
                </div>
                <div class="modal-body">
                  <p>1.ทางเราจะไม่เก็บข้อมูลส่วนตัวของท่าน</p>
                  <p>2.ทางเราจะไม่เปิดเผยข้อมูลตามความสมัครใจของท่านเป็นรายบุคคล</p>
                  <p>3.ทางเราอาจล้างลิสต์ข้อมูลในอดีตได้ตามความเหมาะสม</p>
                  <p>4.ท่านสามารถอ่านข้อตกลงการใช้งานเพิ่มเติมได้ที่ <i class="fas fa-arrow-circle-down"></i></p>
                  <button type="button" onclick="location.href='termsofservice.html'" class="btn btn-outline-dark btn-lg btn-block"><i class="fas fa-info-circle"></i> นโยบายความเป็นส่วนตัว</button>
                </div>
                <div class="modal-footer pulseBtn">
                  <button type="button" class="btn btn-outline-dark btn-warning btn-lg btn-block " data-dismiss="modal"><i class="fas fa-check-circle"></i> ยอมรับข้อตกลงเงื่อนใขการใช้</button>
                </div>
              </div>
          
            </div>
      </div>
     

      <div id="support" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog modal-dialog-centered">
             
              <div class="modal-content ripple1">
                <div class="modal-header">
                  <h4 class="modal-title"><i class="far fa-life-ring"></i> Support</h4>
                </div>
                <div class="modal-body">
                  <p>1.คุณสามารถถามผ่าน Facebook messenger ได้</p>
                  <button type="button" onclick="location.href='https://m.me/HANAHomeBakery'" class="btn btn-outline-dark btn-lg btn-block"><i class="fab fa-facebook-messenger"></i> ติอต่อความช่วยเหลือ</button> 
                  <br></br>
                  <p>2.คุณสามารถถามผ่านการโทรหาเราได้</p>
                  <button type="button" onclick="location.href='tel:081-916-2117'" class="btn btn-outline-dark btn-lg btn-block"><i class="fas fa-phone-alt"></i> ติอต่อความช่วยเหลือ</button>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-outline-light btn-danger btn-lg btn-block fadeInUp" data-toggle="modal" data-dismiss="modal"><i class="far fa-times-circle"></i> Close</button>
                </div>
              </div>
          
            </div>
      </div>

      <div id="ioTable" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog modal2 modal-lg modal-dialog-centered">
            
            <div class="modal-content glass">
            <div class="modal-header">
                  <h4 class="modal-title"><i class="fas fa-list-ul"></i> Orders Data List</h4>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="far fa-times-circle"></i></button>
            </div>
            <div class="modal-body modal2">
                  <div>
                  <input class="form-control" id="ioInput" type="text" placeholder="🔍Search Order ของคุณ ด้วย Order ID">
                  <p> <span class="badge badge-dark">'Status'</span> คือสถานะ Order ของคุณ ณ ขณะนี้มี <span class="badge badge-primary">'รับ'</span> = รับ Order แล้ว <span class="badge badge-warning">'ทำ'</span> = ทำ Order แล้ว <span class="badge badge-success">'ส่ง'</span> = ส่ง Order แล้วสามารถดูด้วย Tracking ID ได้ <span class="badge badge-danger">'ยกเลิก'</span> = ยกเลิก Order แล้ว</p>
                  <div class="border table table-striped table-responsive table-wrapper-scroll-x my-custom-scrollbar" id="io_table">
                        
                        <div id="io_table"></div>
                        
                  </div>
                  </div>
                  <div class="modal-footer">
                        <button type="button" data-toggle="modal" data-dismiss="modal" data-target="#support" class="btn btn-outline-dark btn-block btn-lg"><i class="far fa-life-ring"></i> ติอต่อความช่วยเหลือ</button>
                        <p>
                              <i class="fas fa-arrow-circle-up"></i> ถ้าคุณ <span class="badge badge-warning">! ไม่เจอ Orders !</span> ของคุณท่านสามารถ <span class="badge badge-danger"><i class="far fa-life-ring"></i> กดขอความช่วยเหลือ</span> ได้ที่ปุ่มด้านบนนี้ได้เลย
                        </p>
                  </div>
            </div>
      
            </div>
      </div>
           
      <!-- greensock cdn -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TweenMax.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
      <script src="https://d3js.org/d3.v6.min.js"></script>
      <script type="text/javascript">


            $(function(){
            $('#myModal').modal('show');
            $('#myModal').modal({backdrop: 'static', keyboard: false})
            });
    


            // navigation starts here
            $("#toggle").click(function () {
                  $(this).toggleClass('on');
                  $("#resize").toggleClass("active");
            });

            $("#resize ul li a").click(function () {
                  $(this).toggleClass('on');
                  $("#resize").toggleClass("active");
            });

            $(".close-btn").click(function () {
                  $(this).toggleClass('on');
                  $("#resize").toggleClass("active");
            });

            // navigation ends here

            // nav animation

            TweenMax.from("#brand", 1, {
                  delay: 0.4,
                  y: 10,
                  opacity: 0,
                  ease: Expo.easeInOut
            })

            TweenMax.staggerFrom("#menu li a", 1, {
                  delay: 0.4,
                  opacity: 0,
                  ease: Expo.easeInOut
            }, 0.1);

            // nav animation ends

            new WOW().init();


            // Table
                  
            $(document).ready(function(){
             $('#load_data').ready(function(){
             
                  $.ajax({
                   url:"https://docs.google.com/spreadsheets/d/e/2PACX-1vTtJPwt9bRcpw5A4A1vDuNYdz9PaZm6NUMPO3TAY30LDlpld5JJu2As2YMhadHlVR5s3lekkg6daALl/pub?gid=0&single=true&output=csv",
                   dataType:"text",

            success:function(data) {
            var io_data = data.split(/\r?\n|\r/);
            var table_data = '<table class="table table-bordered table-striped">';

            for(var count = 0; count < io_data.length; count++){
             var cell_data = io_data[count].split(",");
              table_data += '<tr>';

                        for(var cell_count = 0; cell_count < cell_data.length; cell_count++){
                        if(count === 0){
                        table_data += '<th>' + cell_data[cell_count] + '</th>';
                              }

                              else {
                              table_data += '<td>'+cell_data[cell_count]+'</td>';
                              }

                        }
                        table_data += '</tr>';
                  }
                   table_data += '</table>';
            $('#io_table').html(table_data);
            }
            });});});

            $(document).ready(function(){
            $("#ioInput").on("keyup", function() {
                   var value = $(this).val().toLowerCase();
                        $("#io_table tr").filter(function() {
                              $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
                        });
                  });
            });
            // Chart
            d3.csv('https://docs.google.com/spreadsheets/d/e/2PACX-1vTtJPwt9bRcpw5A4A1vDuNYdz9PaZm6NUMPO3TAY30LDlpld5JJu2As2YMhadHlVR5s3lekkg6daALl/pub?gid=741328053&single=true&output=csv').then(makeSum);
            function makeSum(Sum) {
            var sum = Sum.map(function(d) {return d.Sum});
            sum = sum.slice(0,-2);
            document.getElementById("sum").innerHTML = sum;
            }

            d3.csv('https://docs.google.com/spreadsheets/d/e/2PACX-1vTtJPwt9bRcpw5A4A1vDuNYdz9PaZm6NUMPO3TAY30LDlpld5JJu2As2YMhadHlVR5s3lekkg6daALl/pub?gid=741328053&single=true&output=csv').then(makeTime);
            function makeTime(Time) {
            var time = Time.map(function(d) {return d.Time});
            time = time.slice(0,-2);
            document.getElementById("time").innerHTML = time;
            }
           
            d3.csv('https://docs.google.com/spreadsheets/d/e/2PACX-1vTtJPwt9bRcpw5A4A1vDuNYdz9PaZm6NUMPO3TAY30LDlpld5JJu2As2YMhadHlVR5s3lekkg6daALl/pub?gid=741328053&single=true&output=csv').then(makeip);
            function makeip(IP) {
            var ip = IP.map(function(d) {return d.Count});
            ip = ip.slice(0,-2);
            document.getElementById("iput").innerHTML = ip;
            }

            d3.csv('https://docs.google.com/spreadsheets/d/e/2PACX-1vTtJPwt9bRcpw5A4A1vDuNYdz9PaZm6NUMPO3TAY30LDlpld5JJu2As2YMhadHlVR5s3lekkg6daALl/pub?gid=741328053&single=true&output=csv').then(makemake);
            function makemake(MAKE) {
            var make = MAKE.map(function(d) {return d.Count});
            make = make.slice(1,-1);
            document.getElementById("make").innerHTML = make;
            }

            d3.csv('https://docs.google.com/spreadsheets/d/e/2PACX-1vTtJPwt9bRcpw5A4A1vDuNYdz9PaZm6NUMPO3TAY30LDlpld5JJu2As2YMhadHlVR5s3lekkg6daALl/pub?gid=741328053&single=true&output=csv').then(makeop);
            function makeop(OP) {
            var op = OP.map(function(d) {return d.Count});
            op = op.slice(2);
            document.getElementById("oput").innerHTML = op;
            }

            d3.csv('https://docs.google.com/spreadsheets/d/e/2PACX-1vTtJPwt9bRcpw5A4A1vDuNYdz9PaZm6NUMPO3TAY30LDlpld5JJu2As2YMhadHlVR5s3lekkg6daALl/pub?gid=741328053&single=true&output=csv').then(makeChart);
            function makeChart(Sum) {
            var status = Sum.map(function(d) {return d.Status});
            var count = Sum.map(function(d) {return d.Count});
            var ctx = document.getElementById('StatusChart').getContext('2d');
            ctx.height = 100;
            var StatusChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                  labels: status,
                  datasets: [{
                        data: count,
                        backgroundColor: [
                        'rgba(3, 120, 252, 0.25)',
                        'rgba(252, 186, 3, 0.25)',
                        'rgba(3, 252, 128, 0.25)',
                        ],
                        borderColor: [
                        'rgba(3, 120, 252, 1)',
                        'rgba(252, 186, 3, 1)',
                        'rgba(3, 252, 128, 1)',
                        ],
                        borderWidth: 2
                  }],
            
            },
            options: {

                  responsive: true,
                  maintainAspectRatio: true,
                  aspectRatio: 1.5,
                  
                  animation: {
                        duration: 0,
                  },

                  legend: {
                        position: "top",
                        align: "start",
                        
                        labels: {
                              fontColor: '#9c9c9c',
                              fontSize: 12,
                              fontFamily:"'Niramit', sans-serif",
                        }
                        
                  }
             
            }})};     

      </script>

</body>

</html>